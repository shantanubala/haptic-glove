var CNB={isDomReady:false,log:function(msg){if(window.console&&window.console.firebug){console.log(msg)}},environment:function(){this.host=location.hostname;this.apiURS='http://api-rps.cnet.com/rest/v1.0/';this.apiService='http://open-api.bnet.com/rest/v1.0/';this.cnbApiKey='khkhff6jwcmm2474cgjmbvqsqxtuw34y';this.site='';this.siteId='23';this.siteEnv='';this.title='BNET';this.domain='bnet.com';this.cookieHost='.cnet.com';this.ursLogin='http://www.bnet.com/1320-4-45.html';this.helpUrl='http://bnet.custhelp.com/';if(this.host.contains('b2bdev')||this.host.contains('dev1')||this.host.contains('c13')||this.host.contains('cosmo')){this.siteEnv='b2bdev';this.apiURS='http://c17-rps-api-integ-lb.cnet.com:7035/rest/v1.0/';this.apiService='http://internal-api.b2bdev.bnet.com:6450/rest/v1.0/';this.cnbApiKey='';if(this.host.contains('c13')){this.host=CNB.getIrisPrefix()}}else if(this.host.contains('b2buat')){this.siteEnv='b2bdev';this.apiURS='http://c17-rps-api-integ-lb.cnet.com:7035/rest/v1.0/';this.apiService='http://internal-api.b2bdev.bnet.com:6450/rest/v1.0/';this.cnbApiKey=''}if(this.host.contains('techrepublic')){this.site='techrepublic';this.siteId='11';this.title='TechRepublic';this.domain='techrepublic.com.com';this.cookieHost='.com.com';this.ursLogin='http://techrepublic.com.com/1320-4-55.html';this.helpUrl='http://techrepublic.custhelp.com/'}else if(this.host.contains('zdnet')||this.host.contains('zdreviews_dev')){this.site='zdnet';this.siteId='2';this.title='ZDNet';this.domain='zdnet.com';this.cookieHost='.zdnet.com';this.ursLogin='http://www.zdnet.com/1320-4_24-44.html';this.helpUrl='http://zdnet.custhelp.com/'}else if(this.host.contains('moneywatch')){this.site='moneywatch';this.siteId='252';this.title='MoneyWatch';this.domain='bnet.com';this.cookieHost='.bnet.com';this.ursLogin='http://www.bnet.com/1320-4-45.html';this.helpUrl='http://bnet.custhelp.com/'}else if(this.host.contains('bnet')||this.host.contains('industries_dev')){this.site='bnet';this.siteId='23';this.title='BNET';this.domain='bnet.com';this.cookieHost='.bnet.com';this.ursLogin='http://www.bnet.com/1320-4-45.html';this.helpUrl='http://bnet.custhelp.com/'}else if(this.host.contains('findarticles')||this.host.contains('fa_dev')){this.site='findarticles';this.siteId='23';this.title='BNET';this.domain='bnet.com';this.cookieHost='.findarticles.com';this.ursLogin='http://www.bnet.com/1320-4-45.html';this.helpUrl='http://bnet.custhelp.com/'}else if(this.host.contains('smartplanet')){this.site='smartplanet';this.siteId='139';this.title='SmartPlanet';this.domain='smartplanet.com';this.cookieHost='.smartplanet.com';this.ursLogin='http://membership.smartplanet.com/1320-4-213.html';this.helpUrl="javascript:new CNB.Contacter({url:'http://www.smartplanet.com/contact/internal/B2B-Customercare/subject/Smartplanet+Site+Help+%26amp%3B+Feedback', title: 'Site Help &amp; Feedback' })"}return this},getIrisPrefix:function(){var a=location.pathname.split('/');var b='';if(a.length>1){b=(a[1].match('_dev.php'))?'/'+a[1]:''}return b},Cookie:{set:function(name,value,days,host){var expires='';var domain='';if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires='; expires='+date.toGMTString()}if(host){domain='; domain='+host}document.cookie=name+'='+value+expires+'; path=/'+domain},get:function(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length)}return null}},DW:{ping:function(options){try{if(CNB.isDomReady){DW.redir(options)}else{window.addEvent('domready',function(){DW.redir(options)}.bind(this))}}catch(e){CNB.log(e)}}}};(function(){var purs=CNB.Cookie.get('purs_3');var regId=($chk(purs))?purs.substring(40,purs.indexOf('!')):'';CNB.env=CNB.environment();CNB.UserVars=new Hash({'regId':regId,'loggedIn':false})})();Element.Properties.jsonClass={get:function(){var vals=this.get('class').split(' ').filter(function(cls){return cls.test(':')});if(!vals.length){return false}else{var out={};vals.each(function(cls){var split=cls.split(':');if(split[1]){try{out[split[0]]=JSON.decode(split[1])}catch(e){}}});return out}}};CNB.Selector=new Class({Implements:[Options,Events],options:{setCookie:true,cookieName:null,action:'click',startSeq:null,styleType:'display'},initialize:function(tabs,contents,options){this.setOptions(options);this.setElements(tabs,contents);this.initSeq();this.setCookieName();this.checkCookie();this.tabs.each(function(el,i){this.close(i);el.addEvent(this.options.action,function(e){if(!el.hasClass('external')){e=new Event(e).stop();this.setSeq(i);this.close(this.seq.past);this.open(i);this.setCookie()}}.bind(this))}.bind(this));this.open(this.seq.current)},setElements:function(tabs,contents){this.tabs=($type(tabs)=='array')?tabs:[tabs];this.contents=($type(contents)=='array')?contents:[contents]},initSeq:function(){var start=($chk(this.options.startSeq))?this.options.startSeq:0;this.seq={current:start,past:null}},setSeq:function(i){this.seq.past=this.seq.current;this.seq.current=i},open:function(i){this.tabs[i].addClass('on');if(this.options.styleType=='visibility'){this.contents[i].setStyle('visibility','visible');this.contents[i].setStyle('display','block')}else{this.contents[i].setStyle('display','block')}this.fireEvent('open',i)},close:function(i){this.tabs[i].removeClass('on');if(!this.contents[i].hasClass('on-perm')){if(this.options.styleType=='visibility'){this.contents[i].setStyle('visibility','hidden')}else{this.contents[i].setStyle('display','none')}}this.fireEvent('close',i)},checkCookie:function(){if(this.options.setCookie){var cookie=Cookie.read(this.cookieName);if(cookie){this.seq.current=cookie}}},setCookie:function(i){if(this.options.setCookie){Cookie.write(this.cookieName,i,{duration:12})}},setCookieName:function(){this.cookieName=(this.options.cookieName==null)?this.makeCookieName():this.options.cookieName},makeCookieName:function(){var url=document.URL;var name=this.tabs[0].get('text').slice(0,10).replace(/[ \t]/g,"")+"_"+url.slice(url.length-15,url.length-5);return name}});CNB.Pop=new Class({Extends:CNB.Selector,Implements:Options,options:{setCookie:false,cookieName:null,relative:null,shadow:false,styleType:'visibility',location:{x:'left',y:'bottom'},offset:{x:0,y:0}},initialize:function(tabs,contents,options){this.setOptions(options);this.setElements(tabs,contents);this.initSeq();this.tabs.each(function(el,i){this.close(i);this.position(el,this.contents[i]);this.attachEvents(el,i);this.attachEvents(this.contents[i],i);if(this.options.shadow){var shadow=new CNB.Shadow(this.contents[i])}}.bind(this))},position:function(tab,content){var pos=new CNB.Position(content,{relative:this.options.relative,positionTo:tab,location:this.options.location,offset:this.options.offset})},attachEvents:function(el,i){el.addEvent('mouseover',function(e){e=new Event(e).stop();this.setSeq(i);if(i!=this.seq.past){this.close(this.seq.past)}$clear(this.closeDelay);this.openDelay=this.open.pass(i,this).delay(150)}.bind(this));el.addEvent('mouseout',function(e){e=new Event(e).stop();$clear(this.openDelay);this.closeDelay=this.close.pass(i,this).delay(250)}.bind(this))}});CNB.Rotocop=new Class({Implements:[Options,Events],options:{showNumber:3,showNav:false,slide:true,usableDisabled:false,startSeq:0,timer:null,margin:0,contents:null},initialize:function(container,options){this.setOptions(options);this.container=container;this.load()},load:function(){this.fireEvent('load');this.cover=this.container.getElement('.roto-cover');if($chk(this.options.contents)){this.contents=this.options.contents;this.contents.inject(this.cover,'top')}else{this.contents=this.container.getElement('.roto-items')}if(!$chk(this.contents)){return false}this.items=this.contents.getChildren();this.seq=this.options.startSeq;this.z=Math.floor((this.items.length-1)/this.options.showNumber);this.contentSize=this.cover.getSize();if(this.items.length>this.options.showNumber){this.container.addClass('roto-active');this.controls=new Element('div',{'class':'roto-controls'}).inject(this.container,'bottom');this.buildPrev();this.buildNext();if(this.options.showNav){this.buildNav()}if($chk(this.options.timer)){this.setTimer()}}},setTimer:function(){this.rotoTimer=this.next.periodical(this.options.timer,this);var els=[this.prevLink,this.nextLink];if(this.options.showNav){els.extend(this.navItems)}els.each(function(el){el.addEvent('click',function(e){$clear(this.rotoTimer)}.bind(this))}.bind(this))},rotate:function(newSeq){if(this.options.showNav){this.navItems[this.seq].removeClass('on');this.navItems[newSeq].addClass('on')}if(this.seq==this.z){this.nextLink.removeClass('disabled')}else if(this.seq===0){this.prevLink.removeClass('disabled')}if(newSeq===0){this.prevLink.addClass('disabled')}else if(newSeq==this.z){this.nextLink.addClass('disabled')}var shiftSize=this.contentSize.x+this.options.margin;var shift=(newSeq===0)?0:newSeq*shiftSize;if(this.options.slide==true){this.contents.tween('margin-left',"-"+shift+"px")}else{this.contents.setStyle('margin-left',"-"+shift+"px")}this.seq=newSeq},buildNav:function(){this.navItems=[];var navCont=new Element('ul',{'class':'roto-nav clear'}).inject(this.controls,'bottom');for(i=0;i<=this.z;i++){this.navItems[i]=new Element('li',{'html':'<a></a>'}).inject(navCont,'bottom')}this.navItems[0].addClass('on');this.navItems.each(function(el,i){el.addEvent('click',function(e){e=new Event(e).stop();this.rotate(i)}.bind(this))}.bind(this))},buildPrev:function(){this.prevLink=new Element('a',{'class':'roto-prev disabled','html':'Previous'}).inject(this.controls,'bottom');this.prevLink.addEvent('click',function(e){e=new Event(e).stop();if(this.options.usableDisabled||!this.prevLink.hasClass('disabled')){this.prev()}}.bind(this))},buildNext:function(){this.nextLink=new Element('a',{'class':'roto-next','html':'Next'}).inject(this.controls,'bottom');this.nextLink.addEvent('click',function(e){e=new Event(e).stop();if(this.options.usableDisabled||!this.nextLink.hasClass('disabled')){this.next()}}.bind(this))},prev:function(){var seq=(this.seq===0)?this.z:this.seq-1;this.rotate(seq);this.fireEvent('prev')},next:function(){var seq=(this.seq==this.z)?0:this.seq+1;this.rotate(seq);this.fireEvent('next')}});CNB.Pillars={init:function(){this.handles=$$('#pillars h5');this.contents=$$('#pillars .inner');var truncate=new CNB.Truncate($$('#pillars h5 span'),{'length':38}).basic();this.handles.each(function(el,i){var drop=new CNB.fxDrop(this.contents[i]);el.addEvent('click',function(e){e=new Event(e).stop();if(!this.contents[i].hasClass('on')){this.closeAll()}drop.chain(function(){el.toggleClass('on')});drop.toggle()}.bind(this))}.bind(this))},closeAll:function(){this.contents.each(function(el,i){if(el.hasClass('on')){var drop=new CNB.fxDrop(el);this.handles[i].removeClass('on');drop.close()}}.bind(this))}};CNB.fxDrop=new Class({Implements:[Chain,Options],options:{speed:300},initialize:function(element,options){this.setOptions(options);this.element=element;this.height=this.element.getScrollSize().y;if(!this.options.open&&this.element.get('height')!='0'){this.element.setStyles({visibility:'hidden',height:0,overflow:'hidden'})}this.fx=new Fx.Morph(this.element,{duration:this.options.speed,link:'ignore'})},toggle:function(){if(this.element.hasClass('on')){this.close()}else{this.open()}},open:function(){this.element.setStyle('visibility','visible');this.callChain();this.fx.start({'height':this.height});this.element.addClass('on')},close:function(){this.fx.start({'height':0}).chain(function(){this.element.setStyle('visibility','hidden');this.callChain()}.bind(this));this.element.removeClass('on')}});CNB.Tables=new Class({Implements:Options,options:{evenclass:'even',oddclass:'odd'},initialize:function(content,options){this.setOptions(options);if($type(content)!='array'){content=[content]}content.each(function(el){this.stripe(el.getElements('tbody tr'))}.bind(this))},stripe:function(rows){rows.each(function(el,i){var className=(i%2===0)?this.options.oddclass:this.options.evenclass;el.addClass(className)}.bind(this))}});CNB.Position=new Class({Implements:Options,options:{positionTo:null,location:{x:'left',y:'bottom'},position:'absolute',inWindow:false,offEdge:5,relative:null,offset:{x:0,y:0}},initialize:function(elem,options){this.setOptions(options);this.elem=$(elem);this.link=($chk(this.options.positionTo))?$(this.options.positionTo):null;this.elementSize=this.elem.getSize();if($chk(this.link)){var offsetParent=($chk(this.options.relative))?this.options.relative:this.elem.getOffsetParent();this.linkCoords=this.link.getCoordinates(offsetParent);if(this.options.offset.y=='center'){this.options.offset.y='-'+(this.elementSize.y/2-this.linkCoords.height/2)}if(this.options.offset.x=='center'){this.options.offset.x='-'+(this.elementSize.x/2-this.linkCoords.width/2)}if(this.options.inWindow){this.windowStats();this.yActual=this.linkCoords.bottom+this.elementSize.y;this.xActual=this.linkCoords.left+this.elementSize.x;this.yMax=this.windowSize.y+this.windowScroll.y;this.xMax=this.windowSize.x+this.windowScroll.x;this.top=(this.yActual>this.yMax)?this.linkCoords.bottom-((this.yActual-this.yMax)+this.options.offEdge):this.linkCoords.bottom;this.left=(this.xActual>this.xMax)?this.linkCoords.left-((this.xActual-this.xMax)+this.options.offEdge):this.linkCoords.left}else{this.top=this.linkCoords[this.options.location.y]+parseInt(this.options.offset.y);this.left=this.linkCoords[this.options.location.x]+parseInt(this.options.offset.x)}}else{this.windowStats();this.top=(this.windowSize.y/2)-(this.elementSize.y/2)+parseInt(this.options.offset.y);this.left=(this.windowSize.x/2)-(this.elementSize.x/2)+parseInt(this.options.offset.x);if(this.options.position=='absolute'){this.top=this.top+this.windowScroll.y;this.left=this.left+this.windowScroll.x}if(this.top<0){this.top=this.options.offEdge}}this.setPosition()},windowStats:function(){this.windowSize=$(window).getSize();this.windowScroll=$(window).getScroll()},setPosition:function(){this.elem.set('styles',{'position':this.options.position,'top':this.top,'left':this.left})}});CNB.Scrollbar=new Class({Implements:[Options,Events],options:{ignoreMouse:false,mode:'vertical'},initialize:function(content,options){this.setOptions(options);this.steps=(this.options.mode=='horizontal')?content.getScrollSize().x-content.getSize().x:content.getScrollSize().y-content.getSize().y;if(this.steps>0){this.fireEvent('activate');this.scrollbar=new Element('div',{'class':'scrollbar'}).inject(content,'after');this.handle=new Element('div',{'class':'handle'}).inject(this.scrollbar,'top');this.slider=new Slider(this.scrollbar,this.handle,{steps:this.steps,mode:'vertical',onChange:function(step){var x=(this.options.mode=='horizontal')?step:0;var y=(this.options.mode=='horizontal')?0:step;content.scrollTo(x,y)}}).set(0);if(!this.options.ignoreMouse){$$(content,this.scrollbar).addEvent('mousewheel',function(e){e=new Event(e).stop();var step=this.slider.step-e.wheel*30;this.slider.set(step)}.bind(this))}$(document.body).addEvent('mouseleave',function(){this.slider.drag.stop()}.bind(this))}}});CNB.Fixation=new Class({Implements:Options,options:{inset:20},initialize:function(element,container,options){this.setOptions(options);this.element=$(element);this.container=$(container);this.coords=this.container.getCoordinates();this.container.size=this.container.getSize();this.defaults=this.element.getStyles('left','top');this.element.size=this.element.getSize();this.max={top:this.coords.top-this.options.inset+this.defaults.top.toInt(),bottom:this.coords.bottom-this.options.inset,colBottom:this.container.size.y-this.element.size.y};this.fixed=false;this.pos={position:'absolute',top:this.defaults.top,left:this.defaults.left};if(!Browser.Engine.trident4&&(this.element.size.y+this.options.inset<window.getSize().y)){this.attachScroll();this.attachResize()}},attachScroll:function(){window.addEvent('scroll',function(){var scroll=window.getScroll();if(this.fixed&&scroll.y<this.max.top){this.pos={position:'absolute',top:this.defaults.top,left:this.defaults.left};this.setPosition();this.fixed=false}else if(this.fixed&&(scroll.y+this.element.size.y)>this.max.bottom){this.pos={position:'absolute',top:this.max.colBottom,left:this.defaults.left};this.setPosition();this.fixed=false}else if(!this.fixed&&(scroll.y>this.max.top)&&(scroll.y+this.element.size.y<this.max.bottom)){this.pos={position:'fixed',top:this.options.inset,left:this.coords.left};this.setPosition();this.fixed=true}}.bind(this))},attachResize:function(){window.addEvent('resize',function(){this.coords=this.container.getCoordinates();if(this.fixed){this.pos.left=this.coords.left;this.setPosition()}}.bind(this))},setPosition:function(){this.element.setStyles({position:this.pos.position,top:this.pos.top,left:this.pos.left})}});CNB.Pagination=new Class({Implements:Options,options:{count:'10',total:0,start:1,nextAction:$empty,range:4},initialize:function(container,options){this.setOptions(options);this.container=$(container);this.pagetotal=Math.ceil(this.options.total/this.options.count);this.pagelist=new Element('ul',{'class':'clear'}).inject(this.container,'top');this.page=new Element('span',{'class':'page'}).inject(this.container,'bottom');this.set(this.options.start)},set:function(num){this.pagelist.empty();var on=false;var max;if(num<=6){max=(this.pagetotal>10)?10:this.pagetotal;for(i=1;i<=max;i++){on=(i==num)?true:false;this.setItem(i,on)}if(this.pagetotal>max){if(this.pagetotal>(max+1)){this.setItem('sep')}this.setItem(this.pagetotal)}}else{max=(this.pagetotal>(num+this.options.range))?num+this.options.range:this.pagetotal;this.setItem(1,false);this.setItem('sep');for(i=num-this.options.range;i<num;i++){this.setItem(i,on)}this.setItem(num,true);for(i=num+1;i<=max;i++){this.setItem(i,on)}if(this.pagetotal>max){if(this.pagetotal>(max+1)){this.setItem('sep')}this.setItem(this.pagetotal)}}this.page.set('text','page '+num+' of '+this.pagetotal)},setItem:function(i,on){if($type(i)=='number'){var el=new Element('li').set('html','<a>'+i+'</a>').inject(this.pagelist,'bottom').addEvent('click',function(e){e=new Event(e).stop();this.set(i);this.options.nextAction(i)}.bind(this));if(on===true){el.addClass('on')}}else{var sep=new Element('li',{'class':'sep'}).inject(this.pagelist,'bottom').set('text','...')}}});CNB.Layered=new Class({Implements:[Options,Events],options:{id:'layered',container:null,drag:true,width:474,title:'',shadow:true,modal:false,zindex:5500,inputFocus:false,nextAction:$empty,className:'',parentLayer:null,relative:null,maxHeight:true,positionTo:null,inWindow:false,offEdge:10,offset:{x:0,y:0}},initialize:function(contents,options){this.setOptions(options);if($chk(this.options.parentLayer)){this._childLayer(this.options.parentLayer)}this.contents=(this._isDump(contents))?contents.getChildren().clone():contents;if(!CNB.isDomReady&&(Browser.Engine.trident4||Browser.Engine.trident5)){window.addEvent('domready',function(){this.load()}.bind(this))}else{this.load()}return this},load:function(){this.fireEvent('load');this.container=($chk(this.options.container))?$(this.options.container):$(document.body);this._dispose();this.position='absolute';if(this.options.modal){this.modal=new CNB.Modal({id:'modal-'+this.options.id,zindex:this.options.zindex-1});this.modal.load();if(!Browser.Engine.trident4){this.position='fixed'}}this.win=new Element('div',{'id':this.options.id,'class':'layered '+this.options.className,'styles':{'z-index':this.options.zindex}}).inject(this.container,'bottom');if(this.options.width!='-'){this.win.setStyle('width',this.options.width)}this.winHold=new Element('div',{'class':'layered-container'}).inject(this.win,'bottom');this.head=new Element('div',{'id':this.options.id+'-header','class':'layered-header'}).inject(this.winHold,'top');if($chk(this.options.title)){this.head.set('html','<h6>'+this.options.title+'</h6>')}this.closeBtn=new Element('a',{'class':'close close-x','styles':{'z-index':this.options.zindex+1}}).inject(this.winHold,'top');this.contentHold=new Element('div',{'id':this.options.id+'-content','class':'layered-content'}).inject(this.winHold,'bottom');this.content=new Element('div',{'class':'clear loading-zone'}).inject(this.contentHold,'bottom').adopt(this.contents);if($chk(this.options.maxHeight)){var maxHeight=($type(this.options.maxHeight)=='number')?this.options.maxHeight:$(window).getSize().y-100;this.contentHold.setStyles({'max-height':maxHeight,'overflow':'auto'})}this.initClose(this.win);this.options.nextAction();if(this.options.shadow){var shadow=new CNB.Shadow(this.win)}if(this.options.drag){this.drag()}this.fireEvent('complete');this._position();if(this.options.inputFocus){var firstInput=this.content.getElement('input[type!=hidden]');if($chk(firstInput)){firstInput.focus()}}},loading:function(action){if(action=='start'){this.contentHold.addClass('loading');this.content.setStyle('visibility','hidden')}else if(action=='stop'){this.contentHold.removeClass('loading');this.content.setStyle('visibility','visible')}},_dispose:function(parent){if($(this.options.id)){$(this.options.id).dispose();if($('modal-'+this.options.id)){$('modal-'+this.options.id).dispose()}}},_childLayer:function(parent){this.options.zindex=parent.options.zindex+5;this.options.id=parent.options.id+'-child'},_isDump:function(contents){var isDump=$splat(contents).every(function(el){return el.hasClass('dump')});return isDump},_position:function(){var pos=new CNB.Position(this.win,{relative:this.options.relative,positionTo:this.options.positionTo,position:this.position,inWindow:this.options.inWindow,offEdge:this.options.offEdge,offset:{x:this.options.offset.x,y:this.options.offset.y}})},initClose:function(cont){cont.getElements('.close').each(function(el,i){el.addEvent('click',function(e){e=new Event(e).stop();this.close()}.bind(this))}.bind(this))},close:function(transition){if(transition=='fade'){var win=this.win;var fade=new Fx.Tween(win,{property:'opacity'});fade.start(1,0).chain(function(){win.destroy()})}else{this.win.destroy()}if(this.options.modal){this.modal.close()}this.fireEvent('close')},replace:function(newContent){if($type(newContent)=='string'){newContent=new Element('p',{'html':newContent})}else{newContent=(this._isDump(newContent))?newContent.getChildren().clone():newContent}this.content.empty().adopt(newContent);this.initClose(this.content);this._position();this.fireEvent('replace')},drag:function(){this.head.setStyle('cursor','move');var drag=new Drag(this.win,{handle:this.head})}});CNB.Modal=new Class({Implements:[Options,Events],options:{id:'modal',container:null,opacity:'.6',color:'#000',zindex:5000},initialize:function(options){this.setOptions(options);this.container=($chk(this.options.container))?$(this.options.container):$(document.body);var position=(Browser.Engine.trident4)?'absolute':'fixed';this.modal=new Element('div',{'id':this.options.id,'styles':{'class':'modal','position':position,'left':'0','top':'0','width':'100%','height':'100%','z-index':this.options.zindex,'opacity':'0','background-color':this.options.color}});this.fade=new Fx.Tween(this.modal)},load:function(){this.modal.inject(this.container,'bottom');this.fade.start('opacity','.0','.5')},close:function(){this.fade.start('opacity','.5','.0').chain(function(){this.modal.destroy()}.bind(this))}});CNB.Shadow=new Class({Implements:Options,options:{top:true,btm:true,left:true,right:true},initialize:function(container,options){this.setOptions(options);if(!Browser.Engine.trident4){this.container=$(container);if(this.options.top){this.top=new Element('div',{'class':'shadow shadow-top png'}).inject(this.container,'bottom')}if(this.options.btm){this.btm=new Element('div',{'class':'shadow shadow-btm png'}).inject(this.container,'bottom')}if(this.options.left){this.left=new Element('div',{'class':'shadow shadow-left png'}).inject(this.container,'bottom')}if(this.options.right){this.right=new Element('div',{'class':'shadow shadow-right png'}).inject(this.container,'bottom')}}}});CNB.InputFocus=new Class({Implements:Options,options:{container:null,className:'focus'},initialize:function(options){this.setOptions(options);var els=[];if($chk(this.options.container)){var container=$(this.options.container);els=container.getElements('.'+this.options.className)}else{els=$$('.'+this.options.className)}els.each(function(el,i){el.addClass('unfocus');el.removeClass('focus');var original=el.get('value');el.addEvent('focus',function(e){if(el.hasClass('unfocus')){el.removeClass('unfocus');el.set('value','')}}.bind(this));el.addEvent('blur',function(e){if(!$chk(el.get('value'))){el.addClass('unfocus');el.set('value',original)}}.bind(this))}.bind(this))}});CNB.InputState=new Class({Implements:Options,options:{editable:false,classPrefix:'state'},initialize:function(inputs,options){this.setOptions(options);this.inputs=inputs},set:function(options){this.setOptions(options);var editable=this.options.editable;var cl={'original':this.options.classPrefix+'-original','edited':this.options.classPrefix+'-edited'};$splat(this.inputs).each(function(el,i){el.addClass(cl.original);var originalValue=el.get('value');el.addEvent('focus',function(){if(el.hasClass(cl.original)){el.removeClass(cl.original);el.addClass(cl.edited);if(!editable){el.set('value','')}}});el.addEvent('blur',function(){if(!$chk(el.get('value'))||(el.get('value')==originalValue)){el.addClass(cl.original);el.removeClass(cl.edited);el.set('value',originalValue)}})})}});CNB.Replacer=new Class({Implements:Options,options:{destroy:false,stripScripts:false},initialize:function(contents,location,options){this.setOptions(options);if($chk(contents)&&$chk(location)){var html=$(contents).get('html');if(this.options.stripScripts){html=html.stripScripts()}$(location).set('html',html);if(this.options.destroy){$(contents).destroy()}}}});CNB.Contacter=new Class({Implements:Options,options:{url:null,title:'Contact'},initialize:function(options){this.setOptions(options);var holder=new Element('div',{'id':'contact-holder','class':'loading','styles':{'height':'350px'}});var layered=new CNB.Layered(holder,{title:this.options.title});var request=new Request.HTML({onSuccess:function(responseTree,responseElements,responseHTML){holder.set('html',responseHTML).removeClass('loading').setStyle('height','auto');var submit=new CNB.Submitter(holder.getElement('form'));var focus=new CNB.InputFocus({className:'focus-lag'})},onFailure:function(html){holder.removeClass('loading');var msg=new Element('p',{'html':'Unfortunately, the delivery failed. Please try sending your message at our <a href="http://bnet.custhelp.com/">Site Help &amp; Feedback</a> page.','class':'error'}).inject(holder,'top')}}).send({url:this.options.url})}});CNB.Submitter=new Class({Implements:Options,options:{msgSuccess:'It has been submitted. Thanks.',msgFailure:'Something went wrong.'},initialize:function(form,options){this.setOptions(options);this.form=form;var validate=new CNB.Validate(this.form);this.form.addEvent('submit',function(e){e.stop();var submitted=this.submitted.bind(this);this.form.set('send',{onSuccess:function(response){submitted(true)},onFailure:function(response){submitted(false)}});if(validate.isValid()){this.form.send()}}.bind(this))},submitted:function(success){var msgSubmit=(success)?this.options.msgSuccess:this.options.msgFailure;var msg=new Element('p',{'class':'form-success'}).set('text',msgSubmit);msg.replaces(this.form)}});CNB.Truncate=new Class({Implements:Options,options:{format:'characters',length:100,showMore:false,textEnd:'...',textMore:'+more',textLess:'-less'},initialize:function(content,options){this.setOptions(options);this.content=$splat(content)},basic:function(){this.content.each(function(el){if(this._getLength(el.get('text'))>this.options.length){this._setHtml(el,this._getExcerpt(el))}}.bind(this))},moreLess:function(){this.content.each(function(el){if(this._getLength(el.get('text'))>this.options.length){if(this.options.format=='tags'){this._tags(el)}else{this._toggle(el,el.get('html').clean(),this._getExcerpt(el),false)}}}.bind(this))},_tags:function(el){var hiddenCont=new Element('span',{'class':'tags-more','styles':{'display':'none'}}).set('html',', '+this._getHidden(el.get('html').clean()));this._setHtml(el,this._getExcerpt(el));var ellipsis=new Element('span',{'class':'tags-ellipsis'}).set('html',this.options.textEnd).inject(el,'bottom');hiddenCont.inject(el,'bottom');el.addEvents({'mouseenter':function(){ellipsis.setStyle('display','none');hiddenCont.setStyle('display','inline')},'mouseleave':function(){ellipsis.setStyle('display','inline');hiddenCont.setStyle('display','none')}})},_toggle:function(el,html,excerpt,hidden){if(hidden){this._setHtml(el,html);hidden=false;text=this.options.textLess}else{this._setHtml(el,excerpt);hidden=true;text=this.options.textMore}var toggle=this._toggle.bind(this);var btn=new Element('a',{'text':' '+text,'events':{'click':function(e){e=new Event(e).stop();toggle(el,html,excerpt,hidden)}}});var cont=(html.substr(0,6).contains('<p>'))?'p':'span';new Element(cont,{'class':'more'}).adopt(btn).inject(el,'bottom')},_getLength:function(str){var length;switch(this.options.format){case'words':length=str.split(' ').length;break;case'tags':length=str.split(',').length;break;default:length=str.length}return length},_getExcerpt:function(el){var html=el.get('html').clean();var text=el.get('text');switch(this.options.format){case'words':text=text.split(' ').slice(0,this.options.length).join(' ');break;case'tags':text=html.split(',').slice(0,this.options.length).join(', ');break;default:text=text.substring(0,this.options.length)}if(this.options.format!='tags'){text=text.replace(/\w+$/,'').replace(/\s+$/,'');if(html.substr(0,6).contains('<p>')){text='<p>'+text+this.options.textEnd+'</p>'}else{text=text+this.options.textEnd}}return text},_getHidden:function(html){var items=html.split(',').slice(this.options.length).join(', ');return items},_setHtml:function(el,html){el.set('html',html)}});CNB.Validate=new Class({Implements:[Options,Events],options:{msgEmpty:'This field is required',msgEmail:'Please enter a valid email',msgZipcode:'Invalid Postal Code',msgConfirmPw:'Passwords do not match',msgRequireOne:'Please make a selection',msgTooShort:'This field must be at least %x% characters long.',msgTooLong:'This field can\'t be more than %x% characters long.',msgSpecChars:'Special characters are not allowed in this field.'},initialize:function(form,options){this.setOptions(options);this.form=form;this.errorInputs={}},validate:function(el){var val=el.get('value').trim();if(el.hasClass('minlength')){var minlength=this._getLength(el,'min');if(val.length<minlength){this.errorInput(el,this.options.msgTooShort.replace('%x%',minlength));this.wellformed=false}}else if(el.hasClass('maxlength')){var maxlength=this._getLength(el,'max');if(val.length>maxlength){this.errorInput(el,this.options.msgTooLong.replace('%x%',maxlength));this.wellformed=false}}else if(el.hasClass('email')&&(!val.test(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i))){this.errorInput(el,this.options.msgEmail);this.wellformed=false}else if(el.hasClass('confirm-pw')){if(!this.confirmPassword()){this.wellformed=false}}else if(el.hasClass('zipcode-us')&&(!val.test(/^[0-9]+$/))){this.errorInput(el,this.options.msgZipcode);this.wellformed=false}else if(el.hasClass('unfocus')||el.hasClass('state-original')){this.errorInput(el,this.options.msgEmpty);this.wellformed=false}else if(el.hasClass('specialchars')){if(!this.specChars(el)){this.errorInput(el,this.options.msgSpecChars);this.wellformed=false}}if(el.hasClass('required')){if(el.get('type')=='checkbox'||el.get('type')=='radio'){if(el.get('checked')!=true){this.errorInput(el,this.options.msgEmpty);this.wellformed=false}}else if(el.get('type')=='select-one'){var option=el.getElements('option').filter(function(option){return option.selected});if(!$chk(option[0].get('value'))){this.errorInput(el,this.options.msgEmpty);this.wellformed=false}}else{if(!$chk(val)){this.errorInput(el,this.options.msgEmpty);this.wellformed=false}}}},customValidate:function(el,fn){this.clearInput(el);fn(el,this._customCallback.bind(this))},_customCallback:function(el,errStr,isValid){if(!isValid){this.errorInput(el,errStr)}},_getLength:function(el,type){var length=(type=='min')?1:1000;el.get('class').split(" ").each(function(elClass){if(elClass.contains('length-')){length=elClass.slice(7).toInt()}});return length},confirmPassword:function(){var els=this.form.getElements('.password');if(els[0].get('value')!=els[1].get('value')){els.each(function(el,i){this.errorInput(el,this.options.msgConfirmPw)}.bind(this));return false}else{return true}},specChars:function(el){var iChars="%;";var flag=true;for(var i=0;i<el.get('value').length;i++){if(iChars.indexOf(el.get('value').charAt(i))!=-1){flag=false}}return flag},requireOneValidate:function(conts){$splat(conts).each(function(cont){var els=cont.getElements('input');var valid=false;els.each(function(el){if(el.get('type')=='checkbox'||el.get('type')=='radio'){if(el.get('checked')==true){valid=true}}else{if($chk(val)){valid=true}}});if(!valid){this.errorMessage(this.options.msgRequireOne,false,cont);this.wellformed=false}}.bind(this))},isValid:function(){this.wellformed=true;this.clearErrors();var requiredFields=this.form.getElements('.required, .validate');requiredFields.each(function(el){this.validate(el)}.bind(this));this.form.getElements('.require-one').each(function(cont){this.requireOneValidate(cont)}.bind(this));if(this.wellformed){this.fireEvent('valid');return true}else{this.fireEvent('notValid');return false}},clearErrors:function(){this.form.getElements('.error-global').each(function(el){el.destroy()});this.form.getElements('.error-element').each(function(el){this.clearInput(el)}.bind(this))},clearInput:function(el){el.removeClass('error-element');if($chk(this.errorInputs[el.get('name')])){this.errorInputs[el.get('name')].destroy()}var cont=el.getParent('.level-input');if($chk(cont)){cont.removeClass('error-level')}},errorInput:function(el,msg,valid){var cont=el.getParent('.level-input');this.clearInput(el,cont);el.addEvent('focus',this.clearInput.pass([el,cont],this));this.errorInputs[el.get('name')]=new Element('span',{'class':'error-text','html':msg});if($chk(cont)){cont.addClass('error-level');this.errorInputs[el.get('name')].inject(cont,'bottom');el.addClass('error-element');if($chk(valid)){cont.addClass('error-valid')}}else{if($chk(valid)){this.errorInputs[el.get('name')].addClass('error-valid')}else{el.addClass('error-element')}this.errorInputs[el.get('name')].inject(el,'after')}},errorMessage:function(msg,valid,cont){if(this.errorMsg){this.errorMsg.destroy()}var className='error-global';if(valid){className+=' error-valid'}if($type(msg)=='string'){msg=new Element('p',{'html':msg})}this.errorMsg=new Element('div',{'class':className});var spot=($chk(cont))?cont:this.form;this.errorMsg.inject(spot,'top').adopt(msg)}});CNB.FormBuilder=new Class({Implements:[Options,Events],options:{id:'',className:'',focus:false,fieldsets:null,buttons:null,levels:true},initialize:function(options){this.setOptions(options);this.fieldsets={};this.fields={};this.buttons={};this.cont=new Element('div',{'id':this.options.id+'-cont','class':this.options.className+'-cont'});this.form=new Element('form',{'id':this.options.id,'class':this.options.className}).inject(this.cont,'top');this.validate=new CNB.Validate(this.form);if($chk(this.options.fieldsets)){this.addFieldsets(this.options.fieldsets)}if($chk(this.options.buttons)){this.addButtons(this.options.buttons)}this.form.addEvent('submit',function(e){e.stop();var hash=this.fieldHash();this.fireEvent('submitStart',hash);if(this.validate.isValid()){this.fireEvent('submit',hash)}else{this.fireEvent('error')}}.bind(this));return this},addFieldsets:function(data){$splat(data).each(function(el,i){var id=($chk(el.id))?el.id:this.options.id+'-'+i;var className=($chk(el.className))?el.className:'';this.fieldsets[id]=new Element('fieldset',{'id':id,'class':className}).inject(this.form,'bottom');if($chk(el.legend)){var legend=new Element('legend',{'text':el.legend}).inject(this.fieldsets[id],'top')}this.addFields(el.fields,id)}.bind(this))},addFields:function(data,fieldId){radioNum=1;$splat(data).each(function(el,i){var attr={};attr['name']=($chk(el.name))?el.name:fieldId+'-input-'+i;attr.value=($chk(el.value))?el.value:'';attr.type=($chk(el.type))?el.type:'';attr['class']=($chk(el.className))?el.className:'';attr.checked=($chk(el.checked))?el.checked:'';attr.disabled=($chk(el.disabled))?el.disabled:'';attr.id=attr['name']+'-input-'+i;if(attr.type!='hidden'&&this.options.levels){var level=new Element('div',{'id':'level-'+attr.id,'class':'level-input level-'+attr.type+' level-'+attr['name']+' clear'}).inject(this.fieldsets[fieldId],'bottom');if($chk(el.label)){var label=new Element('label',{'for':attr.id,'html':el.label}).inject(level,'bottom')}}var container=(attr.type=='hidden'||!this.options.levels)?this.fieldsets[fieldId]:level;if(attr.type=='select'){this.fields[attr['name']]=new Element('select',{'class':attr['class'],'id':attr.id,'name':attr['name'],'disabled':attr.disabled}).inject(container,'bottom');el.options.each(function(opts,i){var attrOpt={};attrOpt.text=($chk(opts.text))?opts.text:'';attrOpt.value=($chk(opts.value))?opts.value:'';attrOpt.selected=($chk(opts.selected))?opts.selected:'';attrOpt.disabled=($chk(opts.disabled))?opts.disabled:'';new Element('option',attrOpt).inject(this.fields[attr['name']],'bottom')}.bind(this))}else if(attr.type=='textarea'){this.fields[attr['name']]=new Element('textarea',{'class':attr['class'],'id':attr.id,'name':attr['name'],'disabled':attr.disabled,'value':attr.value}).inject(container,'bottom')}else{var spot=(attr.type=='checkbox'||attr.type=='radio')?'top':'bottom';var inputName=attr['name'];if(attr.type=='radio'){inputName=attr['name']+radioNum;radioNum++}this.fields[inputName]=new Element('input',{'name':attr['name'],'type':attr.type,'class':attr['class'],'value':attr.value,'id':attr.id,'checked':attr.checked,'disabled':attr.disabled}).inject(container,spot)}if($chk(el.validate)){this.fields[attr['name']].addEvent(el.validate.event,this.validate.customValidate.bind(this.validate,[this.fields[attr['name']],el.validate.fn]))}if(this.options.focus&&el.type!='hidden'){this.fields[attr['name']].focus();this.options.focus=false}}.bind(this))},addButtons:function(data){if(this.options.levels){var buttonLevel=new Element('div',{'id':this.options.id+'-submit','class':'level-input level-submit clear'}).inject(this.form,'bottom')}var container=(!this.options.levels)?this.form.getLast('fieldset'):buttonLevel;$splat(data).each(function(el,i){var attr={};attr.events={};attr['name']=($chk(el.name))?el.name:this.options.id+'-button-'+i;attr['class']=($chk(el.className))?el.className:'';attr.type=($chk(el.type))?el.type:'button';attr.disabled=($chk(el.disabled))?el.disabled:'';attr.text=($chk(el.text))?el.text:'';if($chk(el.handler)){attr.events.click=el.handler.pass(this.fieldHash());if($chk(el.handler.exec)){attr.events.click=el.handler.exec}}this.buttons[attr['name']]=new Element('button',attr).inject(container,'bottom')}.bind(this))},removeFields:function(inputs){$splat(inputs).each(function(name){delete this.fields[name]}.bind(this))},fieldHash:function(){var fields={};$each(this.fields,function(val,key,object){if(val.get('type')=='checkbox'||val.get('type')=='radio'){if(val.get('checked')==true){fields[val.name]=val.value}}else{if($type(val.value)=='string'){val.value=val.value.trim()}fields[key]=val.value}});return fields}});CNB.Expander=new Class({Implements:Options,options:{displayamount:5,morelinktext:'More',lesslinktext:'Less',speed:600},initialize:function(contents,options){this.setOptions(options);this.contents=$splat(contents);this.contents.each(function(el,i){var items=el.getElements('li');var hidden=true;if(items.length>this.options.displayamount){items=items.slice(this.options.displayamount);this.moreLink(el,items,hidden);this.showHide(items,1,hidden,null,i);this.setScrollTo(i)}}.bind(this))},moreLink:function(el,items,hidden){var showHide=this.showHide.bind(this);var speed=this.options.speed;var more=new Element('p',{'html':'<a>'+this.options.morelinktext+'</a>','class':'more','events':{'click':function(e){e=new Event(e).stop();hidden=(hidden==true)?false:true;showHide(items,speed,hidden,more);if(hidden){new Fx.Scroll(window).toElement($('expander-top'))}}}}).inject(el,'bottom')},showHide:function(items,speed,hidden,more,i){items.each(function(item,i){var myFx=new Fx.Slide(item,{duration:speed,transition:Fx.Transitions.Pow.easeOut});myFx.toggle()});if(more){if(hidden){more.getElement('a').set('text',this.options.morelinktext)}else{more.getElement('a').set('text',this.options.lesslinktext)}}},setScrollTo:function(i){new Element('a',{'id':'expander-top'}).inject(this.contents[i],'before')}});CNB.Quickpoll=new Class({Implements:Options,options:{container:null,question:null,answers:[],template:'zdnet_poll_spons',pollId:null,height:500,width:300},initialize:function(options){this.setOptions(options);this.container=$(this.options.container);this.fields=[]},load:function(){this.b=new CNB.FormBuilder({id:'qpoll-'+this.options.pollId,fieldsets:[{id:'qpoll-opts-'+this.options.pollId,className:'require-one',fields:this._setFields(this.fields)},{id:'qpoll-hidden-'+this.options.pollId,fields:[{name:'action',type:'hidden',value:'vote'},{name:'template_set',type:'hidden',value:this.options.template},{name:'poll_ident',type:'hidden',value:this.options.pollId}]}],buttons:[{name:'btn-vote','text':'Vote',type:'submit',className:'btn btn-vote'},{name:'btn-view-results','text':'View Results',type:'button',className:'btn-view-results',handler:this.results.bind(this)}]});this.b.addEvent('submit',this.loadResults.bind(this));if($chk(this.container)){this.container.adopt(this._setQuestion(this.options.question),this.b.form)}else{CNB.log('Please specify a container for this poll')}},results:function(options){options.action='results';this.b.fireEvent('submit',options)},loadResults:function(options){var iframe=new Element('iframe',{'src':'http://polls.cnet.com/polls/results.php?'+Hash.toQueryString(options),'frameborder':'0','marginheight':'0','marginwidth':'0','scrolling':'no','styles':{'width':'100%','height':this.options.height,'border':'0','overflow':'hidden'}});var layered=new CNB.Layered(iframe,{title:'Quick Poll',className:'qpoll-layered',width:this.options.width})},_setQuestion:function(question){if($type(question)=='string'){question=new Element('p',{'html':question})}var q=new Element('div',{'class':'quick-poll-question'}).adopt(question);return q},_setFields:function(fields){$splat(this.options.answers).each(function(answer,i){fields.push({name:'option_id',type:'radio',value:i+1,label:answer,className:'radio'})});return fields}});window.addEvent('domready',function(){CNB.isDomReady=true;if($$('.focus')!=""){CNB.FocusSet=new CNB.InputFocus()}if($('pillars')){CNB.Pillars.init()}if($('drawer')){CNB.Drawer=new CNB.Fixation('drawer','col1')}if($$('.view-changer')!=""){viewChanger()}});